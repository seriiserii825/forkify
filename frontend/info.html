<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>Forkify File API — fetch примеры</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Prism (подсветка синтаксиса) -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-okaidia.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.css">
  <style>
    :root {
      --bg: #0f1222;
      --panel: #161a2f;
      --panel-2: #1b2040;
      --text: #e8ecff;
      --muted: #abb4d6;
      --brand: #7aa2ff;
      --brand-2: #4ade80;
      --border: #2a2f55;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      color-scheme: dark;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font: 16px/1.6 Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1200px 600px at 10% -10%, #1a1f3f 0%, transparent 60%), 
                  radial-gradient(900px 500px at 100% 0%, #2a1b53 0%, transparent 55%),
                  var(--bg);
      color: var(--text);
    }
    .container {
      max-width: 980px;
      margin: 0 auto;
      padding: 40px 20px 80px;
    }
    header {
      display: grid; gap: 8px;
      margin-bottom: 24px;
    }
    .badge {
      display: inline-flex; align-items: center; gap: 8px;
      font-weight: 600; letter-spacing: .3px; font-size: 12px;
      color: var(--brand);
      background: color-mix(in srgb, var(--brand) 12%, transparent);
      border: 1px solid color-mix(in srgb, var(--brand) 30%, transparent);
      padding: 6px 10px; border-radius: 999px; width: fit-content;
    }
    h1 {
      font-size: clamp(28px, 4vw, 40px);
      margin: 0;
      line-height: 1.2;
      letter-spacing: .2px;
      color: #fff;
      text-shadow: 0 2px 20px rgba(122,162,255,.25);
    }
    .sub {
      color: var(--muted);
      max-width: 700px;
      margin: 6px 0 0;
    }
    .card {
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      border: 1px solid var(--border);
      border-radius: 16px;
      box-shadow: var(--shadow);
      overflow: hidden;
      margin: 22px 0 28px;
    }
    .card__head {
      display: flex; align-items: center; justify-content: space-between;
      padding: 14px 16px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0));
    }
    .card__title {
      margin: 0; font-size: 16px; letter-spacing: .3px;
      color: #fff;
    }
    .btn-copy {
      appearance: none; border: 1px solid var(--border); background: transparent;
      color: var(--muted); border-radius: 10px; padding: 6px 10px; font-weight: 600;
      cursor: pointer; transition: .15s transform, .15s background, .15s color, .15s border;
    }
    .btn-copy:hover { color: var(--text); border-color: color-mix(in srgb, var(--brand) 50%, var(--border)); transform: translateY(-1px); }
    .btn-copy.ok { color: var(--brand-2); border-color: color-mix(in srgb, var(--brand-2) 60%, var(--border)); }
    .code {
      position: relative;
    }
    pre {
      margin: 0;
    }
    .meta {
      color: var(--muted);
      font-size: 14px;
      margin: -10px 0 6px 4px;
    }
    .footnote {
      color: var(--muted);
      margin-top: 36px;
      font-size: 14px;
      opacity: .9;
    }
    /* Prism tweaks */
    code[class*="language-"], pre[class*="language-"] {
      text-shadow: none;
      font-size: 14px;
    }
    .token.keyword { color: #ffa7c4; }
    .token.string { color: #a6e22e; }
    .token.number { color: #ffd866; }
    .token.function { color: #7aa2ff; }
    .token.operator { color: #f78c6c; }
    .token.comment { color: #6b708d; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <span class="badge">Forkify File API • fetch</span>
      <h1>Примеры запросов через <span style="color:var(--brand)">fetch</span></h1>
      <p class="sub">Локальный сервер: <code>http://localhost:3333/api/v2</code>. Выполняй сниппеты по очереди в консоли браузера/Node REPL или вставляй в проект.</p>
    </header>

    <!-- 0. BASE -->
    <section class="card">
      <div class="card__head">
        <h3 class="card__title">пример полного цикла — BASE</h3>
        <button class="btn-copy" data-copy="#code-base">Копировать</button>
      </div>
      <div class="code">
        <pre class="line-numbers"><code id="code-base" class="language-ts">const BASE = "http://localhost:3333/api/v2";</code></pre>
      </div>
    </section>

    <!-- 1. Список -->
    <section class="card">
      <div class="card__head">
        <h3 class="card__title">1) Список рецептов (поиск + пагинация)</h3>
        <button class="btn-copy" data-copy="#code-list">Копировать</button>
      </div>
      <div class="code">
        <pre class="line-numbers"><code id="code-list" class="language-ts">let res = await fetch(`${BASE}/recipes?search=pizza&amp;page=1`);
console.log(await res.json());</code></pre>
      </div>
    </section>

    <!-- 2. Создать -->
    <section class="card">
      <div class="card__head">
        <h3 class="card__title">2) Создать новый рецепт</h3>
        <button class="btn-copy" data-copy="#code-create">Копировать</button>
      </div>
      <div class="code">
        <pre class="line-numbers"><code id="code-create" class="language-ts">res = await fetch(`${BASE}/recipes`, {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    title: "Chocolate Cake",
    publisher: "Serii",
    source_url: "https://example.com/cake",
    image_url: "https://picsum.photos/seed/cake/600/400",
    servings: 8,
    cooking_time: 60,
    ingredients: [
      { quantity: 2, unit: "cup", description: "Flour" },
      { quantity: 1, unit: "cup", description: "Sugar" },
      { quantity: 3, unit: "", description: "Eggs" },
    ],
  }),
});
const created = await res.json();
console.log(created);

const id = created.data.recipe.id;</code></pre>
      </div>
    </section>

    <!-- 3. Получить -->
    <section class="card">
      <div class="card__head">
        <h3 class="card__title">3) Получить рецепт по ID</h3>
        <button class="btn-copy" data-copy="#code-get">Копировать</button>
      </div>
      <div class="code">
        <pre class="line-numbers"><code id="code-get" class="language-ts">res = await fetch(`${BASE}/recipes/${id}`);
console.log(await res.json());</code></pre>
      </div>
    </section>

    <!-- 4. Обновить -->
    <section class="card">
      <div class="card__head">
        <h3 class="card__title">4) Обновить рецепт (частично)</h3>
        <button class="btn-copy" data-copy="#code-update">Копировать</button>
      </div>
      <div class="code">
        <pre class="line-numbers"><code id="code-update" class="language-ts">res = await fetch(`${BASE}/recipes/${id}`, {
  method: "PATCH",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ servings: 10 }),
});
console.log(await res.json());</code></pre>
      </div>
    </section>

    <!-- 5. Удалить -->
    <section class="card">
      <div class="card__head">
        <h3 class="card__title">5) Удалить рецепт</h3>
        <button class="btn-copy" data-copy="#code-delete">Копировать</button>
      </div>
      <div class="code">
        <pre class="line-numbers"><code id="code-delete" class="language-ts">res = await fetch(`${BASE}/recipes/${id}`, { method: "DELETE" });
console.log(await res.json());</code></pre>
      </div>
    </section>

    <p class="footnote">Подсветка — Prism.js (тема Okaidia). Кнопки копируют соответствующий блок кода в буфер обмена.</p>
  </div>

  <!-- Prism scripts -->
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

  <script>
    // копирование кода
    const bySel = s => document.querySelector(s);
    document.querySelectorAll(".btn-copy").forEach(btn => {
      btn.addEventListener("click", async () => {
        const sel = btn.getAttribute("data-copy");
        const code = bySel(sel)?.innerText ?? "";
        try {
          await navigator.clipboard.writeText(code);
          btn.classList.add("ok");
          btn.textContent = "Скопировано ✓";
          setTimeout(() => { btn.classList.remove("ok"); btn.textContent = "Копировать"; }, 1400);
        } catch {
          btn.textContent = "Ошибка копирования";
          setTimeout(() => (btn.textContent = "Копировать"), 1200);
        }
      });
    });
  </script>
</body>
</html>
